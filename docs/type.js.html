<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>type.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Tutorials</li><li class="nav-item"><a href="tutorial-getting-started.html">Getting started</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Error.html">Error</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Errors.html">Errors</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Errors.html#toString">toString</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Generator.html">Generator</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.html">Type</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#.primitive">primitive</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#.register">register</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#.stringify">stringify</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#.toString">toString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#toString">toString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#valid">valid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Type.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Any.html">Any</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Array.html">Array</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Boolean.html">Boolean</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Mixed.html">Mixed</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Nan.html">Nan</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Null.html">Null</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Number.html">Number</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Object.html">Object</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.String.html">String</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Undefined.html">Undefined</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Type.Value.html">Value</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Validation.html">Validation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#annotate">annotate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#cancel">cancel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#continue">continue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#delegate">delegate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#test">test</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#throw">throw</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Validation.html#toString">toString</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">type.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Validation from '~/validation'
import Generator from '~/generator'
import * as utils from '~/utils'

/**
 * Base type class.
 * @class Type
 * @param {object} [options]
 * @param {boolean} [options.optional=false] If set to `true`, type considers `undefined` and `null` as valid.
 */
class Type {
  constructor({optional = false} = {}) {
    if(optional) this.optional = true
  }

  static primitive = utils.primitive
  static stringify = utils.stringify

  /**
   * Allowed primitives. The type only validates values with the given primitives. If empty, the type validates any primitive.
   * @memberof Type
   * @static
   * @type Primitive[]
   * @default []
   */
  static primitives = []

  /**
   * Tests performed by the type to validate a value.
   * @memberof Type
   * @static
   * @type Object.&lt;string, function>
   * @default {}
   */
  static tests = {}

  /**
   * Registers a type class so it become accessible from {@link Type}.
   * @param {function} type The type to register.
   * @return {function} The type you provided.
   * @throws {TypeError} `type` must be a class extending {@link Type}.
   * @example
   * class CustomType extends Type {}
   *
   * Type.register(CustomType)
   * // CustomType
   *
   * new Type.Custom() instanceof CustomType
   * // true
   *
   * Type.custom instanceof CustomType
   * // true
   *
   * Type.custom({optional: true}) instanceof CustomType
   * // true
   */
  static register(type) {
    if(typeof type !== 'function' || !(type.prototype instanceof Type)) {
      throw new TypeError('Can only register classes extending Type.')
    }

    const name = type.toString()
    this[name] = type
    this[name[0].toLowerCase() + name.substring(1)] = new Generator(type)

    return type
  }

  /**
   * Returns the string representation of type.
   * @return {string} String representation of type.
   */
  static toString() {
    const i = this.name.length - 4
    const name = this.name
    return this !== Type &amp;&amp; name.substring(i) === 'Type' ? name.substring(0, i) : name
  }

  /**
   * Validates a value and returns the validation.
   * @param {*} value The value to validate.
   * @return {Validation} A validation corresponding to `value`.
   */
  validate(value) {
    return new Validation(this, value).continue(validation => {
      if(this.optional &amp;&amp; (value === null || value === undefined)) {
        return validation.cancel()
      }

      const primitives = this.constructor.primitives
      const primitive = this.constructor.primitive(value)
      if(primitives.length &amp;&amp; !primitives.includes(primitive)) {
        return validation.errors.add(
          `primitive type must be ${primitives.join(', ')}, got ${primitive}`
        )
      }

      Object.keys(this.constructor.tests).forEach(test => {
        if(test in this) validation.test(test)
      })
    })
  }

  /**
   * Validates a value and check if it succeed. Shortcut for `{@link Type#validate}(value).succeed`.
   * @param {*} value The value to validate.
   * @return {boolean} Equal to `true` if `value` is valid, `false` otherwise.
   */
  valid(value) {
    return this.validate(value).succeed
  }

  /**
   * Returns the string representation of type class.
   * @return {string} String representation of type class.
   */
  toString() {
    const options = Object.values(this).length
      ? `(${this.constructor.stringify(this).slice(1, -1)})`
      : ''
    return `${this.constructor}${options}`
  }
}

export default Type
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
